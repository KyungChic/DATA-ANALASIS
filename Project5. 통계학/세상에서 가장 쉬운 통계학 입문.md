### 세상에서 가장 쉬운 통계학 입문

#### 고지마 히로유키 지음 / 박주영 옮김 / 지상사





##### 표준편차 - 데이터 특수성

- (평균값 + 표준편차x+-1) 범주 안에 데이터의 70%가 들어감(0.6826)
- (평균값 + 표준편차x+-2) 범주 밖에는 2.5%x2 의 데이터만 존재함(0.9544)



##### 신뢰구간의 의미

- 통계적 추정에 있어 95% 신뢰구간이라는 것은 모집단이 95%확률로 그러할 것이라는 것이 아니다.
- 예를들어 동전 앞면이 10번 나왔을 때 몇 번의 시행이 이루어 졌는지(N)에 대한 추정이 있다고 하면, 95% 신뢰구간에서 13<= N <= 30 의 추정이 가능한데,
- N이 13과 30 사이에 있을 확률이 95%라는 것이 아니라, 꾸준히 10번 앞면이 나왔을 때 N을 세어보면 13에서 30 사이에 있을 확률이 95% 라는 것이다.
- 즉, 정리하면 **구간추정이라는 과정을 계속 실행하면 관측값에 대응하는 여러 구간을 구할 수 있지만, 그 100번 중 95번은  N이 구해지는 구간에 들어간다.**



##### 값들의 의미

- 평균값 : 무게중심. 평균값 주변으로 데이터는 분포한다.
- 표준편차 : 평균에서 데이터가 얼마나 멀리 퍼져있는가.
- 분포 : 퍼져있는 모양이 어떠한가.



##### 체비셰프의 부등식

- 정규분포를 생각해보면, 평균을 중심으로 2x표준편차 구간에 대부분의 표본 값들이 존재한다고 말할 수 있다.
- 반대로 생각해보면, 랜덤추출한 표본 x에서 2x표준편차 범위 내에 모평균이 있을 확률은 높다.
- 이를 확장하여 정규분포가 아닌 일반분포에서도 표본 x의 'k x 표준편차' 와 모평균의 관계를 구한 것이 체비셰프의 부등식.
- 구체적으로 말하면, "모평균에서 k x 표준편차 이상 떨어진 데이터는 전체의 1/k^2 의 비율 이하밖에 없다" 는 부등식임.



##### 왜 표본 평균을 구하는가 (대수의 법칙)

- 세로축이 확률, 가로축이 평균값인 그래프를 그린다고 생각해보자.
- 주사위를 한 번 던지면 -> y값이 1/6, x값이 1, 2, 3, 4, 5, 6 인 직사각형의 그래프가 만들어짐.
- 주사위를 두 번 던지면 -> x값이 1, 1.5, 2, 2.5 .... 5.5, 6 의 다양한 값들이 생기며 y축 값도 1/36 ~ 1/6 까지의 값들이 나열된다. -> 종모양의 그래프가 그려짐
- 모평균 값인 3.5에서 확률이 가장 높고 그 밖의 값들에 대해서는 상대적으로 낮은 확률의 그래프를 보이게 됨.
- **결론은 표본이 증가할 수록 표본평균 'x바' 는 모평균에 가까워진다.**
- 정규모집단을 가정하면 표본의 개수를 n이라고 할 때, 표본분산은 '시그마 / 루트(n)'이므로, 표본이 커질수록 평균값에 더 많은 데이터가 모이게 됨. -> 모평균에 가까워짐



##### 표본

-  모평균 '뮤' , 모표준편차 '시그마'라고 하면,
- 표본이 n개일 때 표본평균 'x바'의 <u>분포</u>를 살펴보면 평균 값은 '뮤'에 수렴하며, 표준편차 값은 '시그마 / 루트(n)'의 값을 보인다.
- 이러한 분포를 생각할 때 주의할 점은 단순히 n개의 표본을 통해 계산한 것이 아니라, n개의 표본을 무수히 추출하여 그 분포를 살폈을 때 결정되는 값들이라는 점.
- 그리고 해당 값이 의미하는 것은, 표본의 값을 늘릴 수록, 모집단의 분포보다 더 평균부분으로 밀집된(뾰족한 종모양)의 분포가 성립한다는 것인데,
- 표본의 크기를 키울수록 모평균 근처의 값이 잘 관측되며, 평균에서 떨어진 데이터의 값이 발견될 확률도 줄어들게 된다는 점. 
- 이러한 성질은 정규분포 이외의 분포에도 성립한다.



##### 정규모집단

- 정규분포의 모집단에서는 표본을 추출해도 정규분포가 되는 성질이 있음.
- 따라서 표본을 통해서 구간추정을 해본다고 하면, 표본표준편차인 '시그마/루트(n)'의 값은 표본이 클수록 작아지게 된다
- -> 즉 표본이 커질수록 구간추정의 구간이 작아지게 된다.



##### 카이제곱분포

- 표준모집단의 표본 평균인 'x바'의 분포는 정규분포, 평균은 모평균인 '뮤', 표준편차는 모평균 '시그마 / 루트(n)' 임을 확인하였음.
- 그렇다면 표본의 분산(표준편차)의 분포는 어떠할까? -> 여기서 나온 것이 카이제곱 분포
- 계산상의 편의를 위해서 해당 분포는 표준편차의 분포가 아닌 분산 's제곱'의 분포를 생각함.
- 간단히 생각해봐도, 분산은 음수가 나올 수 없으므로, 해당 분포는 정규분포가 아님을 알 수 있다.



- 분포에 있어 계산의 편의를 위해서 표준정규모집단의 표본 xn에 대해 V = x1^2 + x2^2 + ... + xn^2 으로 산정. 관측값의 제곱의 합으로 설정함. (이 V값의 히스토그램이 카이제곱 분포를 따름.)
  - ---> 표본분산인 s^2 = [(x1-x바)^2 + (x2-x바)^2 + ... (x3-x바)^2] / (n-1)인데, 여기에서 '(xn-x바)'는 표준정규모집단의 표본 - 상수 이므로 정규분포를 따르며, 그것에 상수를 나누어도 정규분포를 따르기 때문에 가능한 것이라 생각함.

- 표본의 수가 3인(자유도가 3인) 분산의 히스토그램을 보면 (p.181) 가운데가 볼록한 모양이 아닌, 왼쪽(0)에 치우친 청룡열차 모양의 히스토그램을 확인할 수 있음. -> 카이제곱분포
- 카이제곱 분포의 특징은 1. 0근처의 상대도수가 크며, 2. 자유도 n이 커질수록 점점 더 오른쪽으로 데이터가 분산됨.



- 이에 따라, 모평균 '뮤'를 안다고 하면, [('관측값 xn' - '뮤') / 모분산 '시그마'^2] 을 바탕으로 구간 추정이 가능해진다. 자유도에 따른 95% 추정 구간에 해당 값을 넣어 계산해줄 수 있는 것.

- 다만 이러한 계산은 모평균 '뮤'를 안다는 가정 자체가 다소 모순이 될 수 있다. -> 모평균을 계산할 수 있었다면, 모분산도 계산할 수 있기에..

-------------------------------



- 그렇다면 모평균 '뮤'를 모르는 상태에서는 어떻게 카이제곱 분포를 적용할 수 있을까?
- '뮤'를 모른다면 구간추정을 위해서는 본래 표본분산을 구했던 산식을 이용할 수 밖에 없다
  - s^2 = [(x1-x바)^2 + ... + (xn-x바)^2] / 자유도(n-1)

- 그렇다면 이와 같은 식(표본분산)에 카이제곱 분포를 어떻게 적용할까? -> W를 이용하기



- 먼저, 다음과 같은 W를 정의해보기

  - W = [{(표본 xn)-(표본평균 x바)}^2 / 모분산 '시그마^2'] 의 총합

- s^2과 W 산식을 비교해보면 분자가 같음을 알 수 있다

  - --> [(n-1) x s^2] = [시그마^2 x W]
  - 표본분산 s^2 = (W x 모분신 '시그마^2') / (n-1)
  - W = (표본분산 's^2' x (n-1) / 모분산 '시그마^2'

- 이때 W는 V에 비해 자유도가 1 감소한 카이제곱 분포를 보인다는 것이 밝혀져 있다.

  - <증명>
  - n개의 표본에 대한 분포도 증명되어 있지만, 간단히 2개의 표본에 대해 생각해보자.
    - V = [(x1-뮤)^2 + (x2-뮤)^2] / 시그마^2
    - W = [(x1-x바)^2 + (x2-x바)^2] / 시그마^2
  - 이때, x바 = [(x1 + x2) / 2] 이므로,
  - W = [{(x1-x2)/2}^2 + {(x2-x1)/2}^2] / 시그마^2 이 되고,
  - 이를 정리하면 W = (x1-x2)^2 / (2 x 시그마^2) = **{(x1 + (-x2)) / 루트(2) x 시그마}^2**

  

  - 이때, W의 평균 값은 [(x_k) + (-x_k+1)] 의 평균이므로, 0이 된다. (총합의 평균값 = 평균값의 총합)

  - 또한, V[(x_k) + (-x_k+1)] = 2 x 시그마^2 이고, 해당 갑의 표준편차는 루트(2) x 시그마 가 되므로, 

  - 결론적으로 x = x_k + (-x_k+1) 이라고 정리하면,

  - W = [[x - E(x)] / 시그마(x)]^2 이 되므로, 표준정규분포를 따른다

    

  - 다만, 이때 E(x) = 0으로 고정되어 버리는 특징이 있기 때문에 **<u>W는 V에 비해 자유도가 1 낮아진다.</u>** (매우 중요!)



##### n-1로 나누는 이유

- 표본 평균은 n으로 나누지만 표본 분산/표준편차 계산에 있어서는 n-1로 나누게 된다.
- 이러한 이유는 표본 분산의 기대값 -> 모분산으로 유도하는 과정이라고 이해해두면 될 것 같다.



##### t분포

- W 값과 카이제곱분포를 통해 표본 데이터 -> 모분산 추정이 가능했다고 한다면, t분포를 통해서는 표본데이터 -> 모평균의 추정이 가능

- **자유도가 n-1 인 통계값 T**
  $$
  T = \frac{(\bar{x}-\mu) \sqrt{n}}{s}
  $$
  
  - <u>모분산을 알 수 없어도 모평균을 추정할 수 있다</u>는 점에서 획기적인 산식임.



- 특징
  - T분포의 히스토그램은 정규분포보다 볼록한 부분이 약간 낮고, 완만한 곳은 높다.
  - ![모평균의 신뢰구간 추정하기 by bskyvision](https://blog.kakaocdn.net/dn/c2oRiP/btqvlhkGZGb/sERdOuu6BtsXaE7QdLkJWk/img.png)
  - 또한, 자유도가 높을수록 가운데가 볼록해진다(0에 가까운 상대도수가 커진다.)



##### t분포의 정식적인 정의

- $$
  T = \frac{Z}{\sqrt{V/k}}
  $$

  - $$
    Z = \frac{\bar{x}-\mu}{\frac{\sigma}{\sqrt{n}}} \ \ \ /\ \ \ V=\Sigma{\frac{{(x_n-\bar{x}})^2}{\sigma^2}} = \frac{s^2(n-1)}{\sigma^2}\ \ \ /\ \ \ k = 자유도
    $$

    - Z 값에서 x바를 기준으로 계산하는 이유는 카이제곱분포 / t분포는 모두 표본의 분포, 즉 x바의 분포에 대한 분포이기 때문이다.
    - (표본평균 bar{x}의 분포는 평균이 mu 이고, 표준편차가 sigma / sqrt{n} 인 정규분포



